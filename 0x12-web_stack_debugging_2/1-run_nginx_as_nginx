#!/bin/bash

# Ensure the nginx user exists
if ! id "nginx" &>/dev/null; then
    useradd -r -s /bin/false nginx
fi

# Change the Nginx user in nginx.conf
sed -i 's/user www-data;/user nginx;/' /etc/nginx/nginx.conf

# Find the server block for port 80 and change it to listen on 8080
sed -i 's/listen 80;/listen 8080;/' /etc/nginx/sites-available/default

# Reload or restart nginx to apply the changes
systemctl restart nginx

# Verify the changes (Optional)
echo "Nginx processes:"
ps aux | grep nginx

echo "Listening ports:"
netstat -tuln | grep :8080


